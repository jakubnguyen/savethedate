<!-- √öprava: prvn√≠ sc√©na ‚Äì pentagon expand + color crossfade (zbytek beze zmƒõny). :contentReference[oaicite:1]{index=1} -->
<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Save the Date</title>
<link href="https://fonts.googleapis.com/css2?family=Cardo:wght@400;700&display=swap" rel="stylesheet">
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Cardo',serif; background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%); min-height:100vh; overflow:hidden; user-select:none; transition:background .8s ease; }
body.simca-mode{ background:linear-gradient(135deg,#d7b0ff 0%,#c9a0ff 100%); }
body.kuba-mode{ background:linear-gradient(135deg,#fffcc9 0%,#fff0a0 100%); }
.container{ position:relative; width:100%; height:100vh; display:flex; justify-content:center; align-items:center; }

/* ‚îÄ‚îÄ PRVN√ç SC√âNA: velk√Ω pentagon s novou animac√≠ (jen tato ƒç√°st je nov√°) ‚îÄ‚îÄ */
.pentagon{
  position:absolute; left:50%; top:50%;
  width:200px; height:200px;
  transform:translate(-50%,-50%);
  background:linear-gradient(135deg,#24b2ff 0%,#1e90ff 100%);
  box-shadow:0 20px 40px rgba(36,178,255,.3);
  clip-path:polygon(50% 0%,100% 38%,82% 100%,18% 100%,0% 38%);
  cursor:pointer; z-index:10; display:flex; justify-content:center; align-items:center;
  will-change:width,height,transform,clip-path,border-radius,opacity;
  transition:
    width 5000ms cubic-bezier(.2,.8,.2,1),
    height 5000ms cubic-bezier(.2,.8,.2,1),
    transform 5000ms cubic-bezier(.2,.8,.2,1),
    clip-path 5000ms cubic-bezier(.2,.8,.2,1),
    border-radius 5000ms cubic-bezier(.2,.8,.2,1),
    box-shadow 5000ms ease;
}
.pentagon:hover{ transform:translate(-50%,-50%) scale(1.05); box-shadow:0 30px 60px rgba(36,178,255,.4); }
.pentagon-text{ color:#fff; font-size:16px; letter-spacing:2px; text-transform:uppercase; text-align:center; animation:pulse 2s infinite; }
@keyframes pulse { 0%,100%{opacity:.7} 50%{opacity:1} }

/* fialov√Ω overlay p≈ô√≠mo na pentagonu ‚Äì barva plynule crossfaduje bƒõhem zvƒõt≈°ov√°n√≠ */
.pentagon::before{
  content:""; position:absolute; inset:0; border-radius:inherit;
  background:linear-gradient(135deg,#d7b0ff 0%, #c9a0ff 100%); /* Simƒça m√≥d */
  opacity:0; transition:opacity 5000ms cubic-bezier(.2,.8,.2,1);
  clip-path:inherit; /* dr≈æ√≠ tvar pentagonu */
}
/* Po kliku: jen roste (a barva fade-in), tvar z≈Øst√°v√° pentagon */
.pentagon.expanding{
  width:220vmax; height:220vmax;
  clip-path:polygon(50% 0%,100% 38%,82% 100%,18% 100%,0% 38%);
  transform:translate(-50%,-50%);
  box-shadow:0 0 0 rgba(0,0,0,0);
}
.pentagon.expanding::before{ opacity:1; }

.small-pentagon{ width:60px; height:60px; background:linear-gradient(135deg,#24b2ff 0%,#1e90ff 100%); position:absolute; clip-path:polygon(50% 0%,100% 38%,82% 100%,18% 100%,0% 38%); cursor:grab; transition:transform .2s ease; box-shadow:0 10px 20px rgba(36,178,255,.3); z-index:15; }
.small-pentagon:hover{ transform:scale(1.1); }
.small-pentagon:active{ cursor:grabbing; transform:scale(0.9); }
.small-pentagon.eaten{ animation:eatAnimation .5s ease forwards; }
@keyframes eatAnimation{ 0%{transform:scale(1);opacity:1} 50%{transform:scale(1.3);opacity:.8} 100%{transform:scale(0);opacity:0} }

.head-container{ position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); opacity:0; visibility:hidden; transition:all .5s ease; z-index:5; }
.head-container.visible{ opacity:1; visibility:visible; }
.svg-head{ width:200px; height:260px; filter:drop-shadow(0 10px 20px rgba(0,0,0,.2)); object-fit:contain; }
.svg-head:hover{ filter:drop-shadow(0 15px 25px rgba(0,0,0,.3)); transform:scale(1.02); }
.mouth-target{ position:absolute; bottom:80px; left:50%; transform:translateX(-50%); width:60px; height:40px; }
.arrow{ position:absolute; top:-80px; left:50%; transform:translateX(-50%); width:0; height:0; border-left:20px solid transparent; border-right:20px solid transparent; border-top:40px solid #ff6b6b; animation:bounce 1s infinite; }
@keyframes bounce{ 0%,100%{transform:translateX(-50%) translateY(0)} 50%{transform:translateX(-50%) translateY(-10px)} }
.instruction{ position:absolute; top:-120px; left:50%; transform:translateX(-50%); color:#333; font-size:18px; text-align:center; white-space:nowrap; }

.final-content{ position:fixed; inset:0; display:flex; flex-direction:column; justify-content:center; align-items:center; opacity:0; visibility:hidden; transition:all .8s ease; background:linear-gradient(135deg,#24b2ff 0%,#1e90ff 100%); color:#fff; text-align:center; z-index:20; padding:2rem; }
.final-content.visible{ opacity:1; visibility:visible; }
.photo-placeholder{ width:280px; height:280px; background:rgba(255,255,255,.1); border-radius:50%; margin-bottom:3rem; display:flex; justify-content:center; align-items:center; backdrop-filter:blur(10px); border:2px solid rgba(255,255,255,.2); position:relative; overflow:hidden; flex-shrink:0; }
.photo-placeholder img{ width:100%; height:100%; object-fit:cover; border-radius:50%; }
.names{ font-size:1.5rem; letter-spacing:4px; text-transform:uppercase; margin-bottom:2rem; color:#fff; }
.date{ font-size:2.5rem; margin-bottom:2rem; color:#fff; }
.save-date-text{ font-size:2.5rem; margin-bottom:1rem; letter-spacing:2px; color:#fff; font-family:'Cardo',serif; }
.save-date-text .big-b{ font-weight:700; color:#1e3a8a; text-transform:uppercase; }
.details{ font-size:1.2rem; line-height:1.6; max-width:600px; color:#fff; }

.progress{ position:fixed; top:20px; left:50%; transform:translateX(-50%); background:rgba(30,30,30,.9); padding:15px 25px; border-radius:30px; color:#fff; font-weight:600; font-size:16px; backdrop-filter:blur(10px); border:2px solid rgba(255,255,255,.1); opacity:0; visibility:hidden; transition:all .3s ease; z-index:25; box-shadow:0 8px 20px rgba(0,0,0,.2); }
.progress.visible{ opacity:1; visibility:visible; }

.mode-control-section{ position:fixed; bottom:20px; left:50%; transform:translateX(-50%); display:flex; align-items:center; gap:16px; opacity:0; visibility:hidden; transition:all .3s ease; z-index:30; }
.mode-control-section.visible{ opacity:1; visibility:visible; }
.mode-button{ min-width:140px; height:48px; background:rgba(30,30,30,.9); color:#fff; padding:0 18px; border-radius:25px; font-size:14px; backdrop-filter:blur(10px); border:2px solid rgba(255,255,255,.1); box-shadow:0 8px 20px rgba(0,0,0,.2); cursor:pointer; transition:all .3s ease; font-family:'Cardo',serif; text-transform:capitalize; display:flex; align-items:center; justify-content:center; font-weight:700; letter-spacing:.3px; }
.mode-button:hover{ transform:scale(1.05); border-color:rgba(255,255,255,.3); }
.mode-button:active{ transform:scale(0.98); }
.mode-button.active{ background:rgba(36,178,255,.9); border-color:rgba(255,255,255,.3); }
.mode-button.inactive{ color:#888; background:rgba(60,60,60,.7); }
.heart-indicator{ width:52px; height:52px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:rgba(30,30,30,.9); border:2px solid rgba(255,255,255,.1); box-shadow:0 8px 20px rgba(0,0,0,.2); font-size:22px; user-select:none; transition:all .3s ease; }

@media (max-width:480px){
  .mode-control-section{ bottom:15px; gap:12px; }
  .mode-button{ min-width:120px; height:44px; font-size:13px; padding:0 14px; }
  .heart-indicator{ width:48px; height:48px; font-size:20px; }
}
@media (max-width:600px) and (min-width:481px){
  .mode-control-section{ gap:14px; }
  .mode-button{ min-width:130px; height:46px; font-size:13px; padding:0 16px; }
  .heart-indicator{ width:50px; height:50px; font-size:21px; }
}
@media (max-width:768px){
  .pentagon{ width:150px; height:150px; }
  .pentagon-text{ font-size:12px; }
  .small-pentagon{ width:45px; height:45px; }
  .instruction{ font-size:14px; top:-100px; }
  .svg-head{ width:150px; height:195px; }
  .mouth-target{ bottom:60px; width:45px; height:30px; }
  .arrow{ top:-60px; border-left:15px solid transparent; border-right:15px solid transparent; border-top:30px solid #ff6b6b; }
  .save-date-text{ font-size:1.9rem; }
  .save-date-text .big-b{ font-size:1.9rem; }
  .date{ font-size:1.8rem; }
  .names{ font-size:1.2rem; letter-spacing:2px; }
  .details{ font-size:1rem; padding:0 1rem; }
  .photo-placeholder{ width:220px; height:220px; margin-bottom:2rem; }
  .progress{ top:15px; padding:10px 18px; font-size:14px; }
}
</style>
</head>
<body>
<audio id="track1" loop>
  <source src="song1.mp3" type="audio/mpeg">
  <source src="song1.ogg" type="audio/ogg">
</audio>
<audio id="track2" loop>
  <source src="song2.mp3" type="audio/mpeg">
  <source src="song2.ogg" type="audio/ogg">
</audio>

<div class="progress" id="progress">Nabito: <span id="fedCount">0</span>/10</div>

<div class="mode-control-section" id="modeControlSection">
  <div class="mode-button active" id="simcaButton">Simƒça Mode</div>
  <div class="heart-indicator" id="heartIndicator">üíú</div>
  <div class="mode-button inactive" id="kubaButton">Kuba Mode</div>
</div>

<div class="container">
  <div class="pentagon" id="mainPentagon"><div class="pentagon-text">Klikni na mƒõ!</div></div>

  <div class="head-container" id="headContainer">
    <div class="instruction">Nakrm mƒõ v≈°emi pentagony!</div>
    <div class="arrow"></div>
    <img src="head.svg" alt="Head with open mouth" class="svg-head">
    <div class="mouth-target" id="mouthTarget"></div>
  </div>

  <div class="final-content" id="finalContent">
    <div class="photo-placeholder"><img src="./fotka.jpg?v=1" alt="Simƒça & Kuba"></div>
    <div class="names">Simƒça & Kuba</div>
    <div class="date">29. 08. 2026</div>
    <div class="save-date-text"><span class="big-b">B</span>udeme se <span class="big-b">B</span>r√°t</div>
    <div class="details">A bez tebe by to nebylo ono.<br>Budeme r√°di, kdy≈æ si na n√°s v tento den udƒõl√°≈° ƒças ‚ò∫Ô∏è</div>
  </div>
</div>

<script>
const mainPentagon = document.getElementById('mainPentagon');
const headContainer = document.getElementById('headContainer');
const mouthTarget = document.getElementById('mouthTarget');
const progress = document.getElementById('progress');
const fedCountSpan = document.getElementById('fedCount');
const finalContent = document.getElementById('finalContent');
const track1 = document.getElementById('track1');
const track2 = document.getElementById('track2');
const modeControlSection = document.getElementById('modeControlSection');
const simcaButton = document.getElementById('simcaButton');
const kubaButton = document.getElementById('kubaButton');
const heartIndicator = document.getElementById('heartIndicator');

let smallPentagons = [];
let fedCount = 0;
let isDragging = false;
let dragElement = null;
let gameStarted = false;
let musicStarted = false;
let currentTrack = 1; // 1 = Simƒça Mode, 2 = Kuba Mode

mainPentagon.addEventListener('click', startGame);
simcaButton.addEventListener('click', () => switchToMode(1));
kubaButton.addEventListener('click', () => switchToMode(2));

function startGame() {
  if (gameStarted) return;
  gameStarted = true;

  mainPentagon.style.opacity = '0';
  mainPentagon.style.transform = 'scale(0)';

  startMusic();
  showControls();

  setTimeout(() => {
    mainPentagon.style.display = 'none';
    createSmallPentagons();
    showHead();
  }, 500);
}

function startMusic() {
  if (!musicStarted) {
    musicStarted = true;
    track1.play().catch(()=>{});
    document.body.classList.add('simca-mode');
  }
}

function showControls() {
  setTimeout(() => {
    modeControlSection.classList.add('visible');
    progress.classList.add('visible');
  }, 1000);
}

function switchToMode(mode) {
  if (!musicStarted) return;
  track1.pause(); track2.pause();
  track1.currentTime = 0; track2.currentTime = 0;
  currentTrack = mode;

  if (currentTrack === 1) {
    track1.play().catch(()=>{});
    document.body.classList.remove('kuba-mode');
    document.body.classList.add('simca-mode');
  } else {
    track2.play().catch(()=>{});
    document.body.classList.remove('simca-mode');
    document.body.classList.add('kuba-mode');
  }
  updateModeDisplay();
}

function updateModeDisplay() {
  if (currentTrack === 1) {
    simcaButton.classList.add('active');  simcaButton.classList.remove('inactive');
    kubaButton.classList.add('inactive'); kubaButton.classList.remove('active');
    heartIndicator.textContent = 'üíú';
  } else {
    kubaButton.classList.add('active');   kubaButton.classList.remove('inactive');
    simcaButton.classList.add('inactive');simcaButton.classList.remove('active');
    heartIndicator.textContent = 'üíõ';
  }
}

/* ===== DYNAMICK√â Mƒö≈òEN√ç DEADZON ===== */
function measureSmallPentagonSize() {
  const probe = document.createElement('div');
  probe.className = 'small-pentagon';
  probe.style.position = 'absolute';
  probe.style.visibility = 'hidden';
  probe.style.left = '-9999px';
  probe.style.top = '-9999px';
  document.body.appendChild(probe);
  const w = probe.offsetWidth || 60;
  const h = probe.offsetHeight || 60;
  probe.remove();
  return { w, h };
}

function getSpawnBounds(pW, pH) {
  const vpW = document.documentElement.clientWidth || window.innerWidth;
  const vpH = window.innerHeight;

  const progressRect = progress.getBoundingClientRect();
  const modeRect = modeControlSection.getBoundingClientRect();

  const gapTop = 8;     // ‚Äûtƒõsnƒõ‚Äú pod horn√≠m prvkem
  const gapBottom = 8;  // ‚Äûtƒõsnƒõ‚Äú nad spodn√≠m prvkem
  const sidePad = 2;    // skoro ≈æ√°dn√° deadzone po stran√°ch

  let minY = Math.max(0, progressRect.bottom + gapTop);
  let maxY = Math.min(vpH - pH, modeRect.top - gapBottom - pH);

  // Fallback pro velmi mal√© obrazovky / horizont√°ly
  if (maxY <= minY) {
    minY = 8;
    maxY = Math.max(8, vpH - pH - 8);
  }

  const minX = sidePad;
  const maxX = Math.max(sidePad, vpW - pW - sidePad);

  return { minX, maxX, minY, maxY };
}
/* ===== KONEC DYNAMIKY ===== */

function createSmallPentagons() {
  const container = document.querySelector('.container');

  // Zmƒõ≈ô aktu√°ln√≠ velikost pentagonu (respektuje media queries)
  const { w: pW, h: pH } = measureSmallPentagonSize();
  const { minX, maxX, minY, maxY } = getSpawnBounds(pW, pH);

  for (let i = 0; i < 10; i++) {
    const smallPentagon = document.createElement('div');
    smallPentagon.className = 'small-pentagon';

    // N√°hodn√° pozice v dynamick√©m ‚Äûkoridoru‚Äú
    const x = minX + Math.random() * Math.max(1, (maxX - minX));
    const y = minY + Math.random() * Math.max(1, (maxY - minY));

    smallPentagon.style.left = x + 'px';
    smallPentagon.style.top  = y + 'px';

    addDragFunctionality(smallPentagon);
    container.appendChild(smallPentagon);
    smallPentagons.push(smallPentagon);
  }
}

function showHead() {
  setTimeout(() => { headContainer.classList.add('visible'); }, 1000);
}

function addDragFunctionality(element) {
  element.addEventListener('mousedown', startDrag);
  element.addEventListener('touchstart', startDrag, { passive: false });
}

function startDrag(e) {
  if (isDragging) return;
  isDragging = true;
  dragElement = e.target;
  e.preventDefault();
  document.addEventListener('mousemove', drag);
  document.addEventListener('mouseup', stopDrag);
  document.addEventListener('touchmove', drag, { passive: false });
  document.addEventListener('touchend', stopDrag);
}

function drag(e) {
  if (!isDragging || !dragElement) return;
  e.preventDefault();

  let clientX, clientY;
  if (e.type === 'touchmove') {
    clientX = e.touches[0].clientX;
    clientY = e.touches[0].clientY;
  } else {
    clientX = e.clientX;
    clientY = e.clientY;
  }

  dragElement.style.left = (clientX - dragElement.offsetWidth / 2) + 'px';
  dragElement.style.top  = (clientY - dragElement.offsetHeight / 2) + 'px';

  checkCollision(dragElement, clientX, clientY);
}

function stopDrag() {
  isDragging = false;
  dragElement = null;
  document.removeEventListener('mousemove', drag);
  document.removeEventListener('mouseup', stopDrag);
  document.removeEventListener('touchmove', drag);
  document.removeEventListener('touchend', stopDrag);
}

function checkCollision(element, x, y) {
  const rect = mouthTarget.getBoundingClientRect();
  const cx = rect.left + rect.width / 2;
  const cy = rect.top + rect.height / 2;
  const d = Math.hypot(x - cx, y - cy);
  if (d < 60) feedPentagon(element);
}

function feedPentagon(element) {
  if (element.classList.contains('eaten')) return;
  element.classList.add('eaten');
  fedCount++;
  fedCountSpan.textContent = fedCount;

  setTimeout(() => {
    element.remove();
    if (fedCount >= 10) showFinalContent();
  }, 500);
}

function showFinalContent() {
  setTimeout(() => {
    headContainer.classList.remove('visible');
    setTimeout(() => finalContent.classList.add('visible'), 500);
  }, 1000);
}

document.addEventListener('dragstart', e => e.preventDefault());
</script>
</body>
</html>
