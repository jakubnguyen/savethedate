<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Save the Date ‚Äì Simƒça & Kuba</title>
  <link href="https://fonts.googleapis.com/css2?family=Forum&display=swap" rel="stylesheet">
  <style>
    /* ---------- Reset & tokens ---------- */
    :root{
      --safe-top: max(12px, env(safe-area-inset-top));
      --safe-bottom: max(12px, env(safe-area-inset-bottom));
      --space: clamp(10px, 2.5vw, 20px);
      --card-w: clamp(160px, 45vw, 280px);
      --hud-radius: 20px;
      --hud-bg: rgba(30,30,30,.9);
      --hud-border: 2px solid rgba(255,255,255,.12);
      --shadow: 0 10px 20px rgba(0,0,0,.22);
      --blue1: #24b2ff; --blue2:#1e90ff;
      --txt: #fff;
    }
    *{ box-sizing: border-box; margin:0; padding:0; }
    html, body { height:100%; }
    body{
      font-family: 'Forum', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      line-height:1.5;
      color: var(--txt);
      background: linear-gradient(135deg, #2b2b2b 0%, #424242 100%);
      min-height: 100dvh; /* stabiln√≠ na mobilech */
      overflow:hidden; user-select:none;
      transition: background .6s ease;
    }
    body.simca-mode{ background: linear-gradient(135deg, #7a4cff 0%, #5a8cff 100%); }
    body.kuba-mode{  background: linear-gradient(135deg, #ffdd6e 0%, #ffc35a 100%); }

    /* ---------- Stage ---------- */
    .container{
      position:relative; width:100%; min-height:100dvh;
      display:flex; align-items:center; justify-content:center;
      padding: max(var(--space), var(--safe-top)) var(--space) max(var(--space), var(--safe-bottom));
    }

    /* velk√Ω pentagon (start) */
    .pentagon{
      position:absolute; inset:auto; width:200px; height:200px;
      background: linear-gradient(135deg, var(--blue1) 0%, var(--blue2) 100%);
      clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
      box-shadow: 0 20px 40px rgba(36,178,255,.28);
      display:flex; align-items:center; justify-content:center; z-index:10;
      cursor:pointer; transition: transform .4s, opacity .4s;
    }
    .pentagon:hover{ transform: scale(1.05); }
    .pentagon-text{ letter-spacing:.18em; text-transform:uppercase; font-size:clamp(12px, 2.7vw, 16px); opacity:.92; }

    /* mal√© pentagony (drag) */
    .small-pentagon{
      position:absolute; width:60px; height:60px;
      background: linear-gradient(135deg, var(--blue1) 0%, var(--blue2) 100%);
      clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
      box-shadow: 0 10px 20px rgba(36,178,255,.28);
      z-index:15; cursor:grab; transition: transform .15s;
      touch-action:none; /* kv≈Øli drag na mobilech */
    }
    .small-pentagon:active{ cursor:grabbing; transform: scale(.92); }
    .small-pentagon.eaten{ animation: eat .45s ease forwards; }
    @keyframes eat{ 0%{transform:scale(1);opacity:1} 60%{transform:scale(1.25);opacity:.85} 100%{transform:scale(0);opacity:0}}

    /* hlava + c√≠lov√° zona */
    .head{
      position:absolute; inset:auto; transform: translate(-50%,-50%);
      left:50%; top:50%; opacity:0; visibility:hidden; transition:.4s;
      z-index:8; text-align:center;
    }
    .head.visible{ opacity:1; visibility:visible; }
    .svg-head{ width:clamp(150px, 38vw, 220px); height:auto; filter: drop-shadow(0 10px 20px rgba(0,0,0,.22)); }
    .mouth-target{ position:absolute; left:50%; transform:translateX(-50%); bottom: clamp(60px, 12vw, 80px); width:60px; height:40px; }
    .instruction{ position:absolute; left:50%; transform:translateX(-50%); top: -90px; font-size:clamp(14px, 3.5vw, 18px); white-space:nowrap; opacity:.95}
    .arrow{ position:absolute; left:50%; transform:translateX(-50%); top:-60px; width:0;height:0;
      border-left:15px solid transparent; border-right:15px solid transparent; border-top:30px solid #ff6b6b;
      animation: bounce 1s infinite; }
    @keyframes bounce{ 0%,100%{ transform:translateX(-50%) translateY(0)} 50%{ transform:translateX(-50%) translateY(-8px)} }

    /* ---------- HUD ---------- */
    .progress{
      position:fixed; top: var(--safe-top); right:12px; transform:none;
      background: var(--hud-bg); border: var(--hud-border); border-radius: var(--hud-radius);
      padding: 10px 16px; font-size: clamp(13px, 2.5vw, 16px); box-shadow: var(--shadow);
      opacity:0; visibility:hidden; transition:.25s; z-index:25;
    }
    .progress.visible{ opacity:1; visibility:visible; }

    .modes{
      position:fixed; top: calc(var(--safe-top) + 4px); left:12px; display:flex; gap:6px; flex-wrap:wrap;
      opacity:0; visibility:hidden; transition:.25s; z-index:25;
    }
    .modes.visible{ opacity:1; visibility:visible; }
    .mode-pill{
      background: var(--hud-bg); border: var(--hud-border); border-radius: 999px; padding:5px 10px;
      font-size: clamp(11px, 2.3vw, 13px); box-shadow: var(--shadow);
    }
    .mode-pill.active{ background: rgba(36,178,255,.9); }

    .music{
      position:fixed; left:50%; transform:translateX(-50%); bottom: var(--safe-bottom);
      display:flex; flex-direction:column; align-items:center; gap:8px; opacity:0; visibility:hidden; transition:.25s; z-index:30;
    }
    .music.visible{ opacity:1; visibility:visible; }
    .music-hint{ background: var(--hud-bg); border: var(--hud-border); border-radius: 999px; padding:8px 12px; box-shadow: var(--shadow); cursor:pointer; font-size:clamp(12px,2.8vw,14px); }
    .music-btn{ width:50px; height:50px; display:grid; place-items:center; border-radius:50%; background:var(--hud-bg); border:var(--hud-border); box-shadow:var(--shadow); font-size:20px; pointer-events:none; }

    /* ---------- Fin√°ln√≠ obrazovka ---------- */
    .final{
      position:fixed; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center;
      padding: var(--space); text-align:center; background: linear-gradient(135deg, var(--blue1) 0%, var(--blue2) 100%);
      opacity:0; visibility:hidden; transition: opacity .5s; z-index:40;
    }
    .final.visible{ opacity:1; visibility:visible; }
    .photo{ width: var(--card-w); height: var(--card-w); border-radius:50%; overflow:hidden; border:2px solid rgba(255,255,255,.22); box-shadow: var(--shadow); margin-bottom: clamp(16px, 3.5vw, 28px); }
    .photo img{ width:100%; height:100%; object-fit:cover; display:block; }
    .title{ font-size: clamp(28px, 6vw, 48px); letter-spacing:.04em; margin-bottom:.25em; }
    .title .big-b{ font-size: clamp(32px, 7vw, 56px); }
    .names{ font-size: clamp(14px, 3.6vw, 22px); letter-spacing:.18em; opacity:.9; text-transform:uppercase; margin-bottom:.6em; }
    .date{ font-size: clamp(22px, 5.4vw, 40px); opacity:.95; margin-bottom:.8em; }
    .details{ font-size: clamp(14px, 3.5vw, 18px); opacity:.85; max-width:min(90vw, 640px); }

    /* ---------- Mobile tweaks ---------- */
    @media (max-width:480px){
      .pentagon{ width:150px; height:150px; }
      .small-pentagon{ width:48px; height:48px; }
    }
  </style>
</head>
<body class="simca-mode">
  <!-- Hudba (voliteln√©) -->
  <audio id="track1" loop preload="none">
    <source src="assets/song1.mp3" type="audio/mpeg">
  </audio>
  <audio id="track2" loop preload="none">
    <source src="assets/song2.mp3" type="audio/mpeg">
  </audio>

  <!-- HUD -->
  <div class="progress" id="progress">Nakrmeno: <span id="fedCount">0</span>/10</div>
  <div class="modes" id="modes">
    <div class="mode-pill active" id="simcaPill">Simƒça Mode: On</div>
    <div class="mode-pill" id="kubaPill">Kuba Mode: Off</div>
  </div>
  <div class="music" id="music">
    <div class="music-hint" id="musicHint">Klikni pro zmƒõnu m√≥du</div>
    <button class="music-btn" id="musicBtn" aria-label="Hudba">üíú</button>
  </div>

  <!-- Sc√©na -->
  <div class="container" id="stage">
    <div class="pentagon" id="start"><div class="pentagon-text">Klikni na mƒõ!</div></div>

    <div class="head" id="head">
      <div class="instruction">Nakrm mƒõ v≈°emi pentagony!</div>
      <div class="arrow"></div>
      <img class="svg-head" src="assets/head.svg" alt="Hlava s otev≈ôenou pusou">
      <div class="mouth-target" id="mouth"></div>
    </div>

    <!-- Fin√°le -->
    <section class="final" id="final">
      <div class="photo"><img src="assets/photo.jpg" alt="Simƒça &amp; Kuba"></div>
      <h1 class="title"><span class="big-b">B</span>udeme se <span class="big-b">B</span>r√°t</h1>
      <div class="names">Simƒça &nbsp;&amp;&nbsp; Kuba</div>
      <div class="date">29. 08. 2026</div>
      <p class="details">Bereme se a chceme, abyste tam byli!<br>V√≠ce detail≈Ø bude n√°sledovat‚Ä¶</p>
    </section>
  </div>

  <script>
    // ------- DOM refs -------
    const stage = document.getElementById('stage');
    const startPent = document.getElementById('start');
    const head = document.getElementById('head');
    const mouth = document.getElementById('mouth');
    const fedEl = document.getElementById('fedCount');
    const progress = document.getElementById('progress');
    const final = document.getElementById('final');
    const music = document.getElementById('music');
    const musicHint = document.getElementById('musicHint');
    const musicBtn = document.getElementById('musicBtn');
    const modes = document.getElementById('modes');
    const simcaPill = document.getElementById('simcaPill');
    const kubaPill = document.getElementById('kubaPill');
    const t1 = document.getElementById('track1');
    const t2 = document.getElementById('track2');

    // ------- state -------
    let started = false, dragging = false, dragEl = null;
    let fed = 0, total = 10, currentTrack = 1, musicStarted = false;
    const smalls = [];

    // ------- helpers -------
    const rand = (min,max)=> Math.random()*(max-min)+min;
    const clamp = (v,min,max)=> Math.max(min, Math.min(max, v));
    const rectB = el => el ? el.getBoundingClientRect() : {top:0,left:0,right:0,bottom:0,width:0,height:0};

    function safeZones(){
      const top = Math.max(rectB(modes).bottom, rectB(progress).bottom) + 12;
      const bottom = Math.max(12, window.innerHeight - rectB(music).top) + 12;
      return {top, bottom, side: 12};
    }

    // ------- init -------
    startPent.addEventListener('click', () => {
      if (started) return;
      started = true;
      startPent.style.opacity = '0';
      startPent.style.transform = 'scale(0.85)';
      setTimeout(()=> startPent.style.display='none', 350);

      // hudba / m√≥dy
      showHUD();
      startMusic(); // jen pokus; iOS pust√≠ a≈æ po interakci (klik probƒõhl)

      // spawn & hlava
      setTimeout(()=>{
        createSmalls();
        head.classList.add('visible');
        progress.classList.add('visible');
      }, 350);
    });

    musicHint.addEventListener('click', switchTrack);

    function showHUD(){
      setTimeout(()=> {
        music.classList.add('visible');
        modes.classList.add('visible');
      }, 300);
    }

    function startMusic(){
      if (musicStarted) return;
      musicStarted = true;
      document.body.classList.add('simca-mode');
      t1.play().catch(()=>{}); // m≈Ø≈æe b√Ωt blokov√°no, nevad√≠
    }

    function switchTrack(){
      if (!musicStarted) return;
      [t1, t2].forEach(a=>{ a.pause(); a.currentTime = 0; });
      currentTrack = currentTrack === 1 ? 2 : 1;
      if (currentTrack === 1){
        t1.play().catch(()=>{});
        document.body.classList.add('simca-mode'); document.body.classList.remove('kuba-mode');
        simcaPill.classList.add('active'); kubaPill.classList.remove('active');
        simcaPill.textContent = 'Simƒça Mode: On'; kubaPill.textContent = 'Kuba Mode: Off';
        musicBtn.textContent = 'üíú';
      }else{
        t2.play().catch(()=>{});
        document.body.classList.add('kuba-mode'); document.body.classList.remove('simca-mode');
        kubaPill.classList.add('active'); simcaPill.classList.remove('active');
        kubaPill.textContent = 'Kuba Mode: On'; simcaPill.textContent = 'Simƒça Mode: Off';
        musicBtn.textContent = 'üíõ';
      }
    }

    function createSmalls(){
      const s = safeZones();
      const size = 60; // pr≈Ømƒõr pentagonu

      for (let i=0;i<total;i++){
        const el = document.createElement('div');
        el.className = 'small-pentagon';
        const xMin = s.side, xMax = window.innerWidth - s.side - size;
        const yMin = s.top,  yMax = window.innerHeight - s.bottom - size;

        el.style.left = clamp(rand(xMin,xMax), xMin, xMax) + 'px';
        el.style.top  = clamp(rand(yMin,yMax), yMin, yMax) + 'px';

        addDrag(el);
        stage.appendChild(el);
        smalls.push(el);
      }
    }

    // ------- drag -------
    function addDrag(el){
      el.addEventListener('mousedown', startDrag);
      el.addEventListener('touchstart', startDrag, {passive:false});
    }
    function startDrag(e){
      if (dragging) return;
      dragging = true;
      dragEl = e.currentTarget;
      e.preventDefault();
      document.addEventListener('mousemove', onDrag);
      document.addEventListener('mouseup', endDrag);
      document.addEventListener('touchmove', onDrag, {passive:false});
      document.addEventListener('touchend', endDrag);
    }
    function onDrag(e){
      if (!dragging || !dragEl) return;
      e.preventDefault();
      const p = (e.touches && e.touches[0]) || e;
      const x = p.clientX, y = p.clientY;
      const half = 30;
      dragEl.style.left = (x - half) + 'px';
      dragEl.style.top  = (y - half) + 'px';
      checkEat(x,y);
    }
    function endDrag(){
      dragging = false; dragEl = null;
      document.removeEventListener('mousemove', onDrag);
      document.removeEventListener('mouseup', endDrag);
      document.removeEventListener('touchmove', onDrag);
      document.removeEventListener('touchend', endDrag);
    }

    // ------- game logic -------
    function checkEat(x,y){
      const r = rectB(mouth);
      const mx = r.left + r.width/2, my = r.top + r.height/2;
      const d = Math.hypot(x-mx, y-my);
      if (d < 60) feed(dragEl);
    }
    function feed(el){
      if (!el || el.classList.contains('eaten')) return;
      el.classList.add('eaten');
      setTimeout(()=> el.remove(), 420);
      fed++; fedEl.textContent = fed;
      if (fed >= total) setTimeout(showFinal, 350);
    }
    function showFinal(){
      head.classList.remove('visible');
      final.classList.add('visible');
    }

    // Bez defaultn√≠ho image-dragu
    document.addEventListener('dragstart', e => e.preventDefault());

    // Reflow safe-zones po otoƒçen√≠ / zmƒõnƒõ UI
    addEventListener('resize', ()=>{ /* respawn by bylo zbyteƒçn√©; nech√°me jak je */ });
  </script>
</body>
</html>
